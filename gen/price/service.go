// Code generated by goa v3.23.1, DO NOT EDIT.
//
// price service
//
// Command:
// $ goa gen stock-bot/design

package price

import (
	"context"
	priceviews "stock-bot/gen/price/views"
)

// The price service provides current stock price information.
type Service interface {
	// Get the current price for a specified stock symbol.
	Get(context.Context, *GetPayload) (res *StockbotPrice, err error)
	// Get historical price data for a specified stock symbol.
	GetHistory(context.Context, *GetHistoryPayload) (res *StockbotHistoricalPrice, err error)
}

// APIName is the name of the API as defined in the design.
const APIName = "stockbot"

// APIVersion is the version of the API as defined in the design.
const APIVersion = "0.0.1"

// ServiceName is the name of the service as defined in the design. This is the
// same value that is set in the endpoint request contexts under the ServiceKey
// key.
const ServiceName = "price"

// MethodNames lists the service method names as defined in the design. These
// are the same values that are set in the endpoint request contexts under the
// MethodKey key.
var MethodNames = [2]string{"get", "get_history"}

// GetHistoryPayload is the payload type of the price service get_history
// method.
type GetHistoryPayload struct {
	// Stock symbol to look up
	Symbol string
	// Number of historical days to retrieve (optional)
	Days uint
}

// GetPayload is the payload type of the price service get method.
type GetPayload struct {
	// Stock symbol to look up
	Symbol string
}

// A single historical price data point.
type HistoricalPriceItem struct {
	// 日付 (YYYY-MM-DD)
	Date string
	// 始値
	Open float64
	// 高値
	High float64
	// 安値
	Low float64
	// 終値
	Close float64
	// 出来高
	Volume *uint64
}

// StockbotHistoricalPrice is the result type of the price service get_history
// method.
type StockbotHistoricalPrice struct {
	// 銘柄コード
	Symbol string
	// 過去の価格データ
	History []*HistoricalPriceItem
}

// StockbotPrice is the result type of the price service get method.
type StockbotPrice struct {
	// 銘柄コード
	Symbol string
	// 現在値
	Price float64
	// 価格取得日時 (RFC3339)
	Timestamp string
}

// NewStockbotPrice initializes result type StockbotPrice from viewed result
// type StockbotPrice.
func NewStockbotPrice(vres *priceviews.StockbotPrice) *StockbotPrice {
	return newStockbotPrice(vres.Projected)
}

// NewViewedStockbotPrice initializes viewed result type StockbotPrice from
// result type StockbotPrice using the given view.
func NewViewedStockbotPrice(res *StockbotPrice, view string) *priceviews.StockbotPrice {
	p := newStockbotPriceView(res)
	return &priceviews.StockbotPrice{Projected: p, View: "default"}
}

// NewStockbotHistoricalPrice initializes result type StockbotHistoricalPrice
// from viewed result type StockbotHistoricalPrice.
func NewStockbotHistoricalPrice(vres *priceviews.StockbotHistoricalPrice) *StockbotHistoricalPrice {
	return newStockbotHistoricalPrice(vres.Projected)
}

// NewViewedStockbotHistoricalPrice initializes viewed result type
// StockbotHistoricalPrice from result type StockbotHistoricalPrice using the
// given view.
func NewViewedStockbotHistoricalPrice(res *StockbotHistoricalPrice, view string) *priceviews.StockbotHistoricalPrice {
	p := newStockbotHistoricalPriceView(res)
	return &priceviews.StockbotHistoricalPrice{Projected: p, View: "default"}
}

// newStockbotPrice converts projected type StockbotPrice to service type
// StockbotPrice.
func newStockbotPrice(vres *priceviews.StockbotPriceView) *StockbotPrice {
	res := &StockbotPrice{}
	if vres.Symbol != nil {
		res.Symbol = *vres.Symbol
	}
	if vres.Price != nil {
		res.Price = *vres.Price
	}
	if vres.Timestamp != nil {
		res.Timestamp = *vres.Timestamp
	}
	return res
}

// newStockbotPriceView projects result type StockbotPrice to projected type
// StockbotPriceView using the "default" view.
func newStockbotPriceView(res *StockbotPrice) *priceviews.StockbotPriceView {
	vres := &priceviews.StockbotPriceView{
		Symbol:    &res.Symbol,
		Price:     &res.Price,
		Timestamp: &res.Timestamp,
	}
	return vres
}

// newStockbotHistoricalPrice converts projected type StockbotHistoricalPrice
// to service type StockbotHistoricalPrice.
func newStockbotHistoricalPrice(vres *priceviews.StockbotHistoricalPriceView) *StockbotHistoricalPrice {
	res := &StockbotHistoricalPrice{}
	if vres.Symbol != nil {
		res.Symbol = *vres.Symbol
	}
	if vres.History != nil {
		res.History = make([]*HistoricalPriceItem, len(vres.History))
		for i, val := range vres.History {
			if val == nil {
				res.History[i] = nil
				continue
			}
			res.History[i] = transformPriceviewsHistoricalPriceItemViewToHistoricalPriceItem(val)
		}
	}
	return res
}

// newStockbotHistoricalPriceView projects result type StockbotHistoricalPrice
// to projected type StockbotHistoricalPriceView using the "default" view.
func newStockbotHistoricalPriceView(res *StockbotHistoricalPrice) *priceviews.StockbotHistoricalPriceView {
	vres := &priceviews.StockbotHistoricalPriceView{
		Symbol: &res.Symbol,
	}
	if res.History != nil {
		vres.History = make([]*priceviews.HistoricalPriceItemView, len(res.History))
		for i, val := range res.History {
			if val == nil {
				vres.History[i] = nil
				continue
			}
			vres.History[i] = transformHistoricalPriceItemToPriceviewsHistoricalPriceItemView(val)
		}
	} else {
		vres.History = []*priceviews.HistoricalPriceItemView{}
	}
	return vres
}

// transformPriceviewsHistoricalPriceItemViewToHistoricalPriceItem builds a
// value of type *HistoricalPriceItem from a value of type
// *priceviews.HistoricalPriceItemView.
func transformPriceviewsHistoricalPriceItemViewToHistoricalPriceItem(v *priceviews.HistoricalPriceItemView) *HistoricalPriceItem {
	if v == nil {
		return nil
	}
	res := &HistoricalPriceItem{
		Date:   *v.Date,
		Open:   *v.Open,
		High:   *v.High,
		Low:    *v.Low,
		Close:  *v.Close,
		Volume: v.Volume,
	}

	return res
}

// transformHistoricalPriceItemToPriceviewsHistoricalPriceItemView builds a
// value of type *priceviews.HistoricalPriceItemView from a value of type
// *HistoricalPriceItem.
func transformHistoricalPriceItemToPriceviewsHistoricalPriceItemView(v *HistoricalPriceItem) *priceviews.HistoricalPriceItemView {
	res := &priceviews.HistoricalPriceItemView{
		Date:   &v.Date,
		Open:   &v.Open,
		High:   &v.High,
		Low:    &v.Low,
		Close:  &v.Close,
		Volume: v.Volume,
	}

	return res
}
