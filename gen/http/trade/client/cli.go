// Code generated by goa v3.23.1, DO NOT EDIT.
//
// trade HTTP client CLI support package
//
// Command:
// $ goa gen stock-bot/design

package client

import (
	"encoding/json"
	"fmt"
	trade "stock-bot/gen/trade"
	"strconv"

	goa "goa.design/goa/v3/pkg"
)

// BuildGetPriceHistoryPayload builds the payload for the trade
// get_price_history endpoint from CLI flags.
func BuildGetPriceHistoryPayload(tradeGetPriceHistorySymbol string, tradeGetPriceHistoryDays string) (*trade.GetPriceHistoryPayload, error) {
	var err error
	var symbol string
	{
		symbol = tradeGetPriceHistorySymbol
	}
	var days uint
	{
		if tradeGetPriceHistoryDays != "" {
			var v uint64
			v, err = strconv.ParseUint(tradeGetPriceHistoryDays, 10, strconv.IntSize)
			days = uint(v)
			if err != nil {
				return nil, fmt.Errorf("invalid value for days, must be UINT")
			}
		}
	}
	v := &trade.GetPriceHistoryPayload{}
	v.Symbol = symbol
	v.Days = days

	return v, nil
}

// BuildPlaceOrderPayload builds the payload for the trade place_order endpoint
// from CLI flags.
func BuildPlaceOrderPayload(tradePlaceOrderBody string) (*trade.PlaceOrderPayload, error) {
	var err error
	var body PlaceOrderRequestBody
	{
		err = json.Unmarshal([]byte(tradePlaceOrderBody), &body)
		if err != nil {
			return nil, fmt.Errorf("invalid JSON for body, \nerror: %s, \nexample of valid JSON:\n%s", err, "'{\n      \"order_type\": \"MARKET\",\n      \"position_account_type\": \"CASH\",\n      \"price\": 0.5029484076227678,\n      \"quantity\": 11455506375708637715,\n      \"symbol\": \"Laborum earum.\",\n      \"trade_type\": \"BUY\",\n      \"trigger_price\": 0.4347058532188131\n   }'")
		}
		if !(body.TradeType == "BUY" || body.TradeType == "SELL") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.trade_type", body.TradeType, []any{"BUY", "SELL"}))
		}
		if !(body.OrderType == "MARKET" || body.OrderType == "LIMIT" || body.OrderType == "STOP") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.order_type", body.OrderType, []any{"MARKET", "LIMIT", "STOP"}))
		}
		if !(body.PositionAccountType == "CASH" || body.PositionAccountType == "MARGIN_NEW" || body.PositionAccountType == "MARGIN_REPAY") {
			err = goa.MergeErrors(err, goa.InvalidEnumValueError("body.position_account_type", body.PositionAccountType, []any{"CASH", "MARGIN_NEW", "MARGIN_REPAY"}))
		}
		if err != nil {
			return nil, err
		}
	}
	v := &trade.PlaceOrderPayload{
		Symbol:              body.Symbol,
		TradeType:           body.TradeType,
		OrderType:           body.OrderType,
		Quantity:            body.Quantity,
		Price:               body.Price,
		TriggerPrice:        body.TriggerPrice,
		PositionAccountType: body.PositionAccountType,
	}
	{
		var zero float64
		if v.Price == zero {
			v.Price = 0
		}
	}
	{
		var zero float64
		if v.TriggerPrice == zero {
			v.TriggerPrice = 0
		}
	}
	{
		var zero string
		if v.PositionAccountType == zero {
			v.PositionAccountType = "CASH"
		}
	}

	return v, nil
}

// BuildCancelOrderPayload builds the payload for the trade cancel_order
// endpoint from CLI flags.
func BuildCancelOrderPayload(tradeCancelOrderOrderID string) (*trade.CancelOrderPayload, error) {
	var orderID string
	{
		orderID = tradeCancelOrderOrderID
	}
	v := &trade.CancelOrderPayload{}
	v.OrderID = orderID

	return v, nil
}
