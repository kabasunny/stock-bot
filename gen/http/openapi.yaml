swagger: "2.0"
info:
    title: Stock Bot Service
    description: Service for placing and managing stock orders
    version: 0.0.1
host: localhost:8080
consumes:
    - application/json
    - application/xml
    - application/gob
produces:
    - application/json
    - application/xml
    - application/gob
paths:
    /balance:
        get:
            tags:
                - balance
            summary: get balance
            description: Get the account balance summary.
            operationId: balance#get
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotBalance'
            schemes:
                - http
    /master/stocks/{symbol}:
        get:
            tags:
                - master
            summary: get_stock master
            description: Get basic master data for a single stock.
            operationId: master#get_stock
            parameters:
                - name: symbol
                  in: path
                  description: Stock symbol to look up
                  required: true
                  type: string
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotStockMaster'
            schemes:
                - http
    /master/update:
        post:
            tags:
                - master
            summary: update master
            description: Trigger a manual update of the master data.
            operationId: master#update
            responses:
                "202":
                    description: Accepted response.
            schemes:
                - http
    /order:
        post:
            tags:
                - order
            summary: create order
            description: Create a new stock order.
            operationId: order#create
            parameters:
                - name: CreateRequestBody
                  in: body
                  required: true
                  schema:
                    $ref: '#/definitions/OrderCreateRequestBody'
                    required:
                        - symbol
                        - trade_type
                        - order_type
                        - quantity
            responses:
                "201":
                    description: Created response.
                    schema:
                        $ref: '#/definitions/OrderCreateResponseBody'
                        required:
                            - order_id
            schemes:
                - http
    /positions:
        get:
            tags:
                - position
            summary: list position
            description: List current positions.
            operationId: position#list
            parameters:
                - name: type
                  in: query
                  description: 取得するポジション種別 (all, cash, margin)
                  required: false
                  type: string
                  default: all
                  enum:
                    - all
                    - cash
                    - margin
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotPositionCollection'
            schemes:
                - http
definitions:
    OrderCreateRequestBody:
        title: OrderCreateRequestBody
        type: object
        properties:
            is_margin:
                type: boolean
                description: 信用取引かどうか
                default: false
                example: true
            order_type:
                type: string
                description: 注文種別 (MARKET/LIMITなど)
                example: STOP_LIMIT
                enum:
                    - MARKET
                    - LIMIT
                    - STOP
                    - STOP_LIMIT
            price:
                type: number
                description: 発注価格 (LIMIT注文の場合)
                default: 0
                example: 0.8222687742177984
                format: double
            quantity:
                type: integer
                description: 発注数量
                example: 10768461267398400549
                format: int64
            symbol:
                type: string
                description: '銘柄コード (例: 7203)'
                example: Et fugiat nam nobis qui.
            trade_type:
                type: string
                description: 売買区分 (BUY/SELL)
                example: BUY
                enum:
                    - BUY
                    - SELL
        example:
            is_margin: false
            order_type: STOP_LIMIT
            price: 0.538007214151295
            quantity: 9018386650614693378
            symbol: Aliquam magni eum omnis.
            trade_type: SELL
        required:
            - symbol
            - trade_type
            - order_type
            - quantity
    OrderCreateResponseBody:
        title: OrderCreateResponseBody
        type: object
        properties:
            order_id:
                type: string
                description: 受付済み注文ID
                example: Ratione non repudiandae quibusdam accusantium ut.
        description: ID of the created order
        example:
            order_id: Dolorum repellat facilis distinctio autem.
        required:
            - order_id
    PositionResult:
        title: PositionResult
        type: object
        properties:
            average_cost:
                type: number
                description: 平均取得単価
                example: 0.9072600383635819
                format: double
            current_price:
                type: number
                description: 現在値
                example: 0.868196972880344
                format: double
            opened_date:
                type: string
                description: 建日 (信用取引の場合 YYYYMMDD)
                example: Aut sit est aperiam minus quia sunt.
            position_type:
                type: string
                description: ポジション種別 (CASH, MARGIN_LONG, MARGIN_SHORT)
                example: MARGIN_LONG
                enum:
                    - CASH
                    - MARGIN_LONG
                    - MARGIN_SHORT
            quantity:
                type: number
                description: 保有数量
                example: 0.10997712919660992
                format: double
            symbol:
                type: string
                description: 銘柄コード
                example: Voluptatibus sed delectus et aut accusamus.
            unrealized_pl:
                type: number
                description: 評価損益
                example: 0.7156682760184558
                format: double
            unrealized_pl_rate:
                type: number
                description: 評価損益率(%)
                example: 0.08281484536016209
                format: double
        description: A single trading position.
        example:
            average_cost: 0.13519314773396515
            current_price: 0.02151845411595506
            opened_date: Natus vel aut repudiandae veniam non.
            position_type: MARGIN_LONG
            quantity: 0.7748741291598161
            symbol: Fuga sit placeat magni.
            unrealized_pl: 0.46713331406267644
            unrealized_pl_rate: 0.022056089018759956
        required:
            - symbol
            - position_type
            - quantity
            - average_cost
    StockbotBalance:
        title: 'Mediatype identifier: application/vnd.stockbot.balance; view=default'
        type: object
        properties:
            available_cash_for_stock:
                type: number
                description: 現物株式買付可能額
                example: 0.6621056743497284
                format: double
            available_margin_for_new_position:
                type: number
                description: 信用新規建可能額
                example: 0.07469073423109131
                format: double
            has_margin_call:
                type: boolean
                description: 追証発生フラグ (1:発生, 0:未発生)
                example: true
            margin_maintenance_rate:
                type: number
                description: 委託保証金率(%)
                example: 0.3663596780501805
                format: double
            withdrawable_cash:
                type: number
                description: 出金可能額
                example: 0.35872211035911955
                format: double
        description: GetResponseBody result type (default view)
        example:
            available_cash_for_stock: 0.5190300316544106
            available_margin_for_new_position: 0.6645791409873505
            has_margin_call: true
            margin_maintenance_rate: 0.7487887991108492
            withdrawable_cash: 0.19084728109418947
        required:
            - available_cash_for_stock
            - available_margin_for_new_position
            - margin_maintenance_rate
            - withdrawable_cash
            - has_margin_call
    StockbotPositionCollection:
        title: 'Mediatype identifier: application/vnd.stockbot.position-collection; view=default'
        type: object
        properties:
            positions:
                type: array
                items:
                    $ref: '#/definitions/PositionResult'
                description: 保有ポジションのリスト
                example:
                    - average_cost: 0.30031297063048695
                      current_price: 0.43519422619906417
                      opened_date: Voluptatem pariatur.
                      position_type: MARGIN_LONG
                      quantity: 0.7337068483551654
                      symbol: Dolore at quasi tempore odio.
                      unrealized_pl: 0.30792511416078117
                      unrealized_pl_rate: 0.7158894831971462
                    - average_cost: 0.30031297063048695
                      current_price: 0.43519422619906417
                      opened_date: Voluptatem pariatur.
                      position_type: MARGIN_LONG
                      quantity: 0.7337068483551654
                      symbol: Dolore at quasi tempore odio.
                      unrealized_pl: 0.30792511416078117
                      unrealized_pl_rate: 0.7158894831971462
        description: ListResponseBody result type (default view)
        example:
            positions:
                - average_cost: 0.30031297063048695
                  current_price: 0.43519422619906417
                  opened_date: Voluptatem pariatur.
                  position_type: MARGIN_LONG
                  quantity: 0.7337068483551654
                  symbol: Dolore at quasi tempore odio.
                  unrealized_pl: 0.30792511416078117
                  unrealized_pl_rate: 0.7158894831971462
                - average_cost: 0.30031297063048695
                  current_price: 0.43519422619906417
                  opened_date: Voluptatem pariatur.
                  position_type: MARGIN_LONG
                  quantity: 0.7337068483551654
                  symbol: Dolore at quasi tempore odio.
                  unrealized_pl: 0.30792511416078117
                  unrealized_pl_rate: 0.7158894831971462
        required:
            - positions
    StockbotStockMaster:
        title: 'Mediatype identifier: application/vnd.stockbot.stock-master; view=default'
        type: object
        properties:
            industry_code:
                type: string
                description: 業種コード
                example: Eligendi et consequatur maxime maxime porro nam.
            industry_name:
                type: string
                description: 業種コード名
                example: Aliquid provident dolores laboriosam eaque quas aut.
            market:
                type: string
                description: 優先市場
                example: Pariatur suscipit corrupti.
            name:
                type: string
                description: 銘柄名
                example: Voluptatem quas sunt magnam et.
            name_kana:
                type: string
                description: 銘柄名（カナ）
                example: In perferendis quia.
            symbol:
                type: string
                description: 銘柄コード
                example: Illo vel nemo.
        description: get_stock_response_body result type (default view)
        example:
            industry_code: Earum perspiciatis et non.
            industry_name: Rem vitae numquam blanditiis.
            market: Qui molestiae.
            name: Eos quisquam.
            name_kana: Aut commodi sunt nobis maiores veritatis.
            symbol: Repudiandae ab laudantium itaque.
        required:
            - symbol
            - name
            - market
