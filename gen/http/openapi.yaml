swagger: "2.0"
info:
    title: Stock Bot Service
    description: Service for placing and managing stock orders
    version: 0.0.1
host: localhost:8080
consumes:
    - application/json
    - application/xml
    - application/gob
produces:
    - application/json
    - application/xml
    - application/gob
paths:
    /balance:
        get:
            tags:
                - balance
            summary: get balance
            description: Get the account balance summary.
            operationId: balance#get
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotBalance'
            schemes:
                - http
    /master/stocks/{symbol}:
        get:
            tags:
                - master
            summary: get_stock master
            description: Get basic master data for a single stock.
            operationId: master#get_stock
            parameters:
                - name: symbol
                  in: path
                  description: Stock symbol to look up
                  required: true
                  type: string
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotStockMaster'
            schemes:
                - http
    /master/update:
        post:
            tags:
                - master
            summary: update master
            description: Trigger a manual update of the master data.
            operationId: master#update
            responses:
                "202":
                    description: Accepted response.
            schemes:
                - http
    /order:
        post:
            tags:
                - order
            summary: create order
            description: Create a new stock order.
            operationId: order#create
            parameters:
                - name: CreateRequestBody
                  in: body
                  required: true
                  schema:
                    $ref: '#/definitions/OrderCreateRequestBody'
                    required:
                        - symbol
                        - trade_type
                        - order_type
                        - quantity
            responses:
                "201":
                    description: Created response.
                    schema:
                        $ref: '#/definitions/OrderCreateResponseBody'
                        required:
                            - order_id
            schemes:
                - http
    /positions:
        get:
            tags:
                - position
            summary: list position
            description: List current positions.
            operationId: position#list
            parameters:
                - name: type
                  in: query
                  description: 取得するポジション種別 (all, cash, margin)
                  required: false
                  type: string
                  default: all
                  enum:
                    - all
                    - cash
                    - margin
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotPositionCollection'
            schemes:
                - http
    /price/{symbol}:
        get:
            tags:
                - price
            summary: get price
            description: Get the current price for a specified stock symbol.
            operationId: price#get
            parameters:
                - name: symbol
                  in: path
                  description: Stock symbol to look up
                  required: true
                  type: string
            responses:
                "200":
                    description: OK response.
                    schema:
                        $ref: '#/definitions/StockbotPrice'
            schemes:
                - http
definitions:
    OrderCreateRequestBody:
        title: OrderCreateRequestBody
        type: object
        properties:
            is_margin:
                type: boolean
                description: 信用取引かどうか
                default: false
                example: true
            order_type:
                type: string
                description: 注文種別 (MARKET/LIMITなど)
                example: LIMIT
                enum:
                    - MARKET
                    - LIMIT
                    - STOP
                    - STOP_LIMIT
            price:
                type: number
                description: 発注価格 (LIMIT注文の場合)
                default: 0
                example: 0.8662440939465682
                format: double
            quantity:
                type: integer
                description: 発注数量
                example: 11934871274813675997
                format: int64
            symbol:
                type: string
                description: '銘柄コード (例: 7203)'
                example: Magnam atque sequi qui.
            trade_type:
                type: string
                description: 売買区分 (BUY/SELL)
                example: SELL
                enum:
                    - BUY
                    - SELL
        example:
            is_margin: true
            order_type: STOP_LIMIT
            price: 0.23471217473283684
            quantity: 17855931352718988984
            symbol: Repudiandae veniam non praesentium est facilis.
            trade_type: BUY
        required:
            - symbol
            - trade_type
            - order_type
            - quantity
    OrderCreateResponseBody:
        title: OrderCreateResponseBody
        type: object
        properties:
            order_id:
                type: string
                description: 受付済み注文ID
                example: Quas aut sit est aperiam minus.
        description: ID of the created order
        example:
            order_id: Sunt in fuga sit placeat.
        required:
            - order_id
    PositionResult:
        title: PositionResult
        type: object
        properties:
            average_cost:
                type: number
                description: 平均取得単価
                example: 0.7685586878127862
                format: double
            current_price:
                type: number
                description: 現在値
                example: 0.8978293485226214
                format: double
            opened_date:
                type: string
                description: 建日 (信用取引の場合 YYYYMMDD)
                example: Perspiciatis et.
            position_type:
                type: string
                description: ポジション種別 (CASH, MARGIN_LONG, MARGIN_SHORT)
                example: CASH
                enum:
                    - CASH
                    - MARGIN_LONG
                    - MARGIN_SHORT
            quantity:
                type: number
                description: 保有数量
                example: 0.345748444796004
                format: double
            symbol:
                type: string
                description: 銘柄コード
                example: Quisquam voluptatibus aut commodi sunt nobis.
            unrealized_pl:
                type: number
                description: 評価損益
                example: 0.20235174436491518
                format: double
            unrealized_pl_rate:
                type: number
                description: 評価損益率(%)
                example: 0.35469033390882565
                format: double
        description: A single trading position.
        example:
            average_cost: 0.21600814125337545
            current_price: 0.4655131055999334
            opened_date: Cumque facere animi culpa.
            position_type: MARGIN_LONG
            quantity: 0.8361459848823616
            symbol: Maiores rem vitae.
            unrealized_pl: 0.8433708523094668
            unrealized_pl_rate: 0.16272212765614372
        required:
            - symbol
            - position_type
            - quantity
            - average_cost
    StockbotBalance:
        title: 'Mediatype identifier: application/vnd.stockbot.balance; view=default'
        type: object
        properties:
            available_cash_for_stock:
                type: number
                description: 現物株式買付可能額
                example: 0.4165074722003021
                format: double
            available_margin_for_new_position:
                type: number
                description: 信用新規建可能額
                example: 0.9959528064207535
                format: double
            has_margin_call:
                type: boolean
                description: 追証発生フラグ (1:発生, 0:未発生)
                example: true
            margin_maintenance_rate:
                type: number
                description: 委託保証金率(%)
                example: 0.029312683239780778
                format: double
            withdrawable_cash:
                type: number
                description: 出金可能額
                example: 0.8048046943628897
                format: double
        description: GetResponseBody result type (default view)
        example:
            available_cash_for_stock: 0.47988821131403053
            available_margin_for_new_position: 0.4944308050558556
            has_margin_call: true
            margin_maintenance_rate: 0.20017066173279813
            withdrawable_cash: 0.936767151500364
        required:
            - available_cash_for_stock
            - available_margin_for_new_position
            - margin_maintenance_rate
            - withdrawable_cash
            - has_margin_call
    StockbotPositionCollection:
        title: 'Mediatype identifier: application/vnd.stockbot.position-collection; view=default'
        type: object
        properties:
            positions:
                type: array
                items:
                    $ref: '#/definitions/PositionResult'
                description: 保有ポジションのリスト
                example:
                    - average_cost: 0.20340772017935024
                      current_price: 0.9305668997749629
                      opened_date: Quisquam fugiat sit voluptatum tempora.
                      position_type: CASH
                      quantity: 0.7640472947931707
                      symbol: Dolorem quia ut id repudiandae.
                      unrealized_pl: 0.7963175162716686
                      unrealized_pl_rate: 0.42170577463801534
                    - average_cost: 0.20340772017935024
                      current_price: 0.9305668997749629
                      opened_date: Quisquam fugiat sit voluptatum tempora.
                      position_type: CASH
                      quantity: 0.7640472947931707
                      symbol: Dolorem quia ut id repudiandae.
                      unrealized_pl: 0.7963175162716686
                      unrealized_pl_rate: 0.42170577463801534
                    - average_cost: 0.20340772017935024
                      current_price: 0.9305668997749629
                      opened_date: Quisquam fugiat sit voluptatum tempora.
                      position_type: CASH
                      quantity: 0.7640472947931707
                      symbol: Dolorem quia ut id repudiandae.
                      unrealized_pl: 0.7963175162716686
                      unrealized_pl_rate: 0.42170577463801534
                    - average_cost: 0.20340772017935024
                      current_price: 0.9305668997749629
                      opened_date: Quisquam fugiat sit voluptatum tempora.
                      position_type: CASH
                      quantity: 0.7640472947931707
                      symbol: Dolorem quia ut id repudiandae.
                      unrealized_pl: 0.7963175162716686
                      unrealized_pl_rate: 0.42170577463801534
        description: ListResponseBody result type (default view)
        example:
            positions:
                - average_cost: 0.20340772017935024
                  current_price: 0.9305668997749629
                  opened_date: Quisquam fugiat sit voluptatum tempora.
                  position_type: CASH
                  quantity: 0.7640472947931707
                  symbol: Dolorem quia ut id repudiandae.
                  unrealized_pl: 0.7963175162716686
                  unrealized_pl_rate: 0.42170577463801534
                - average_cost: 0.20340772017935024
                  current_price: 0.9305668997749629
                  opened_date: Quisquam fugiat sit voluptatum tempora.
                  position_type: CASH
                  quantity: 0.7640472947931707
                  symbol: Dolorem quia ut id repudiandae.
                  unrealized_pl: 0.7963175162716686
                  unrealized_pl_rate: 0.42170577463801534
                - average_cost: 0.20340772017935024
                  current_price: 0.9305668997749629
                  opened_date: Quisquam fugiat sit voluptatum tempora.
                  position_type: CASH
                  quantity: 0.7640472947931707
                  symbol: Dolorem quia ut id repudiandae.
                  unrealized_pl: 0.7963175162716686
                  unrealized_pl_rate: 0.42170577463801534
                - average_cost: 0.20340772017935024
                  current_price: 0.9305668997749629
                  opened_date: Quisquam fugiat sit voluptatum tempora.
                  position_type: CASH
                  quantity: 0.7640472947931707
                  symbol: Dolorem quia ut id repudiandae.
                  unrealized_pl: 0.7963175162716686
                  unrealized_pl_rate: 0.42170577463801534
        required:
            - positions
    StockbotPrice:
        title: 'Mediatype identifier: application/vnd.stockbot.price; view=default'
        type: object
        properties:
            price:
                type: number
                description: 現在値
                example: 0.8345352422736791
                format: double
            symbol:
                type: string
                description: 銘柄コード
                example: Corrupti optio eligendi et consequatur maxime maxime.
            timestamp:
                type: string
                description: 価格取得日時 (RFC3339)
                example: Et aliquid.
        description: GetResponseBody result type (default view)
        example:
            price: 0.09293933887114668
            symbol: Dolores laboriosam.
            timestamp: Aut necessitatibus repudiandae ab laudantium itaque id.
        required:
            - symbol
            - price
            - timestamp
    StockbotStockMaster:
        title: 'Mediatype identifier: application/vnd.stockbot.stock-master; view=default'
        type: object
        properties:
            industry_code:
                type: string
                description: 業種コード
                example: Et aut porro minus ex.
            industry_name:
                type: string
                description: 業種コード名
                example: Molestiae doloremque ipsa molestiae.
            market:
                type: string
                description: 優先市場
                example: Sint perspiciatis quis sequi.
            name:
                type: string
                description: 銘柄名
                example: Et quibusdam.
            name_kana:
                type: string
                description: 銘柄名（カナ）
                example: Est reiciendis repudiandae ut.
            symbol:
                type: string
                description: 銘柄コード
                example: Aut et.
        description: get_stock_response_body result type (default view)
        example:
            industry_code: Error earum tempore.
            industry_name: Est voluptate corrupti voluptatem qui quibusdam aut.
            market: Dolore saepe voluptatem laudantium quia.
            name: Quia et dolore.
            name_kana: Enim ut velit dolorem quia amet.
            symbol: Voluptatibus repellat et.
        required:
            - symbol
            - name
            - market
